{"apiVersion":"1.0.0","swaggerVersion":"1.2","basePath":"https://rest.ehrscape.com/rest/v1","resourcePath":"/presentation","apis":[{"path":"/presentation","operations":[{"method":"POST","summary":"Returns presentation documents for a specified AQL query.","notes":"<p>Returns presentation documents returned by the AQL query. Their content can be filtered by forms specified in request body.</p><p>Query should only return COMPOSITIONs, all other values will be ignored.</p> Several forms can be specified for filtering - they will be matched to the template of each composition. Compositions without a matching form for filtering will be returned with basic reference model filtering.</p><p>Here is how parameters (AQL query and its parameters as well as forms) are specified in the JSON body: </p><p><pre style=\"overflow-y: auto\"><code>{\n  \"queryRequestData\": {\n    \"aql\": \"SELECT c FROM Composition c CONTAINS OBSERVATION o[openEHR-EHR-OBSERVATION.body_temperature-zn.v1] WHERE o/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value/magnitude < :temp FETCH 1\",\n    \"aqlParameters\": {\n      \"temp\": 40\n    }\n  },\n  \"formData\": [\n    {\n      \"formName\": \"Demo Vitals\",\n      \"versionString\": \"1.0.0\"\n    }\n  ]\n}</code></pre></p><p>The returned result-set is a collection of presentation documents.</p><p>An example of a successful response body:</p><p><pre style=\"overflow-y: auto\"><code>[\n    {\n      \"metadata\": {\n        \"startTime\": \"2014-03-11T10:27:09.933+01:00\",\n        \"composer\": \"restTest\",\n        \"name\": \"Vitals\",\n        \"templateId\": \"Demo Vitals\"\n      },\n      \"composition\": {\n        \"rmType\": \"COMPOSITION\",\n        \"label\": \"Vitals\",\n        \"children\": [\n          {\n            \"rmType\": \"SECTION\",\n            \"label\": \"Vitals\",\n            \"children\": [\n              {\n                \"rmType\": \"OBSERVATION\",\n                \"label\": \"Body temperature\",\n                \"children\": [\n                  {\n                    \"rmType\": \"DV_QUANTITY\",\n                    \"label\": \"Temperature\",\n                    \"displayValue\": \"37.2 °C\",\n                    \"rawValue\": {\n                      \"magnitude\": 37.2,\n                      \"units\": \"°C\",\n                      \"other_reference_ranges\": []\n                    },\n                    \"aqlPath\": \"/content[openEHR-EHR-SECTION.ispek_dialog.v1,'Vitals']/items[openEHR-EHR-OBSERVATION.body_temperature-zn.v1]/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value\"\n                  }\n                ],\n                \"aqlPath\": \"/content[openEHR-EHR-SECTION.ispek_dialog.v1,'Vitals']/items[openEHR-EHR-OBSERVATION.body_temperature-zn.v1]\"\n              }\n            ],\n            \"aqlPath\": \"/content[openEHR-EHR-SECTION.ispek_dialog.v1,'Vitals']\"\n          }\n        ]\n      }\n    }\n]</pre></code></p>","type":"void","nickname":"getPresentationDocuments","produces":["application/json"],"parameters":[{"name":"body","required":false,"type":"PresentationRequestData","paramType":"body","allowMultiple":false}],"responseMessages":[{"code":200,"message":"Success - at least one document will be returned."},{"code":204,"message":"No content - no results."},{"code":400,"message":"Bad request - cannot parse AQL (QRY-4135), EHR placeholder could not be expanded due to EHR not set (EHR-2031)."},{"code":401,"message":"Unauthenticated - could not authenticate user (SYS-9401)."},{"code":403,"message":"Forbidden - the user does not have the required permissions to execute this request (SYS-9403)."}]}]}],"models":{"PresentationRequestData":{"id":"PresentationRequestData","description":"Data required for presentation request.","required":["queryRequestData"],"properties":{"queryRequestData":{"$ref":"QueryRequestData","description":"Query to retrieve presentation documents"},"formData":{"type":"array","description":"List of forms for document content filtering","items":{"$ref":"PresentationFormData"}}}},"QueryRequestData":{"id":"QueryRequestData","description":"Specify aql with (optionally) named parameters in the :parameterName format.","properties":{"aql":{"type":"string","description":"The AQL to execute, optionally with :parameterName placeholders"},"aqlParameters":{"$ref":"Map[string,Object]","description":"The mapping of named parameters to values"}}},"PresentationFormData":{"id":"PresentationFormData","description":"Adds a form to presentation request for filtering.","required":["formName","formVersion"],"properties":{"formName":{"type":"string","description":"Form name"},"formVersion":{"type":"string","description":"Form version"}}}}}